"use strict";var CesiumNavigation=function(e){initialize.apply(this,arguments),this._onDestroyListeners=[]};function initialize(e,t){if(!Cesium.defined(e))throw new Cesium.DeveloperError("CesiumWidget or Viewer is required.");var i=Cesium.defined(e.cesiumWidget)?e.cesiumWidget:e,o=document.createElement("div");o.className="cesium-widget-cesiumNavigationContainer",i.container.appendChild(o),this.terria=e,this.terria.options=Cesium.defined(t)?t:{},this.terria.afterWidgetChanged=new Cesium.Event,this.terria.beforeWidgetChanged=new Cesium.Event,this.container=o,Cesium.defined(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls||Cesium.defined(this.terria.options.enableCompass)&&!this.terria.options.enableCompass?!Cesium.defined(this.terria.options.enableZoomControls)||this.terria.options.enableZoomControls||defined(this.terria.options.enableCompass)&&!this.terria.options.enableCompass?Cesium.defined(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls||!defined(this.terria.options.enableCompass)||this.terria.options.enableCompass||(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),o.appendChild(this.navigationDiv),this.navigationViewModel=NavigationViewModel.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!0,enableCompass:!1})):(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),o.appendChild(this.navigationDiv),this.navigationViewModel=NavigationViewModel.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!1,enableCompass:!0})):(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),o.appendChild(this.navigationDiv),this.navigationViewModel=NavigationViewModel.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!0,enableCompass:!0}))}CesiumNavigation.prototype.distanceLegendViewModel=void 0,CesiumNavigation.prototype.navigationViewModel=void 0,CesiumNavigation.prototype.navigationDiv=void 0,CesiumNavigation.prototype.distanceLegendDiv=void 0,CesiumNavigation.prototype.terria=void 0,CesiumNavigation.prototype.container=void 0,CesiumNavigation.prototype._onDestroyListeners=void 0,CesiumNavigation.prototype.destroy=function(){Cesium.defined(this.navigationViewModel)&&this.navigationViewModel.destroy(),Cesium.defined(this.distanceLegendViewModel)&&this.distanceLegendViewModel.destroy(),Cesium.defined(this.navigationDiv)&&this.navigationDiv.parentNode.removeChild(this.navigationDiv),delete this.navigationDiv,Cesium.defined(this.distanceLegendDiv)&&this.distanceLegendDiv.parentNode.removeChild(this.distanceLegendDiv),delete this.distanceLegendDiv,Cesium.defined(this.container)&&this.container.parentNode.removeChild(this.container),delete this.container;for(var e=0;e<this._onDestroyListeners.length;e++)this._onDestroyListeners[e]()},CesiumNavigation.prototype.addOnDestroyListener=function(e){"function"==typeof e&&this._onDestroyListeners.push(e)};var svgCompassGyro="m 72.71875,54.375 c -0.476702,0 -0.908208,0.245402 -1.21875,0.5625 -0.310542,0.317098 -0.551189,0.701933 -0.78125,1.1875 -0.172018,0.363062 -0.319101,0.791709 -0.46875,1.25 -6.91615,1.075544 -12.313231,6.656514 -13,13.625 -0.327516,0.117495 -0.661877,0.244642 -0.9375,0.375 -0.485434,0.22959 -0.901634,0.471239 -1.21875,0.78125 -0.317116,0.310011 -0.5625,0.742111 -0.5625,1.21875 l 0.03125,0 c 0,0.476639 0.245384,0.877489 0.5625,1.1875 0.317116,0.310011 0.702066,0.58291 1.1875,0.8125 0.35554,0.168155 0.771616,0.32165 1.21875,0.46875 1.370803,6.10004 6.420817,10.834127 12.71875,11.8125 0.146999,0.447079 0.30025,0.863113 0.46875,1.21875 0.230061,0.485567 0.470708,0.870402 0.78125,1.1875 0.310542,0.317098 0.742048,0.5625 1.21875,0.5625 0.476702,0 0.876958,-0.245402 1.1875,-0.5625 0.310542,-0.317098 0.582439,-0.701933 0.8125,-1.1875 0.172018,-0.363062 0.319101,-0.791709 0.46875,-1.25 6.249045,-1.017063 11.256351,-5.7184 12.625,-11.78125 0.447134,-0.1471 0.86321,-0.300595 1.21875,-0.46875 0.485434,-0.22959 0.901633,-0.502489 1.21875,-0.8125 0.317117,-0.310011 0.5625,-0.710861 0.5625,-1.1875 l -0.03125,0 c 0,-0.476639 -0.245383,-0.908739 -0.5625,-1.21875 C 89.901633,71.846239 89.516684,71.60459 89.03125,71.375 88.755626,71.244642 88.456123,71.117495 88.125,71 87.439949,64.078341 82.072807,58.503735 75.21875,57.375 c -0.15044,-0.461669 -0.326927,-0.884711 -0.5,-1.25 -0.230061,-0.485567 -0.501958,-0.870402 -0.8125,-1.1875 -0.310542,-0.317098 -0.710798,-0.5625 -1.1875,-0.5625 z m -0.0625,1.40625 c 0.03595,-0.01283 0.05968,0 0.0625,0 0.0056,0 0.04321,-0.02233 0.1875,0.125 0.144288,0.147334 0.34336,0.447188 0.53125,0.84375 0.06385,0.134761 0.123901,0.309578 0.1875,0.46875 -0.320353,-0.01957 -0.643524,-0.0625 -0.96875,-0.0625 -0.289073,0 -0.558569,0.04702 -0.84375,0.0625 C 71.8761,57.059578 71.936151,56.884761 72,56.75 c 0.18789,-0.396562 0.355712,-0.696416 0.5,-0.84375 0.07214,-0.07367 0.120304,-0.112167 0.15625,-0.125 z m 0,2.40625 c 0.448007,0 0.906196,0.05436 1.34375,0.09375 0.177011,0.592256 0.347655,1.271044 0.5,2.03125 0.475097,2.370753 0.807525,5.463852 0.9375,8.9375 -0.906869,-0.02852 -1.834463,-0.0625 -2.78125,-0.0625 -0.92298,0 -1.802327,0.03537 -2.6875,0.0625 0.138529,-3.473648 0.493653,-6.566747 0.96875,-8.9375 0.154684,-0.771878 0.320019,-1.463985 0.5,-2.0625 0.405568,-0.03377 0.804291,-0.0625 1.21875,-0.0625 z m -2.71875,0.28125 c -0.129732,0.498888 -0.259782,0.987558 -0.375,1.5625 -0.498513,2.487595 -0.838088,5.693299 -0.96875,9.25 -3.21363,0.15162 -6.119596,0.480068 -8.40625,0.9375 -0.682394,0.136509 -1.275579,0.279657 -1.84375,0.4375 0.799068,-6.135482 5.504716,-11.036454 11.59375,-12.1875 z M 75.5,58.5 c 6.043169,1.18408 10.705093,6.052712 11.5,12.15625 -0.569435,-0.155806 -1.200273,-0.302525 -1.875,-0.4375 -2.262525,-0.452605 -5.108535,-0.783809 -8.28125,-0.9375 -0.130662,-3.556701 -0.470237,-6.762405 -0.96875,-9.25 C 75.761959,59.467174 75.626981,58.990925 75.5,58.5 z m -2.84375,12.09375 c 0.959338,0 1.895843,0.03282 2.8125,0.0625 C 75.48165,71.267751 75.5,71.871028 75.5,72.5 c 0,1.228616 -0.01449,2.438313 -0.0625,3.59375 -0.897358,0.0284 -1.811972,0.0625 -2.75,0.0625 -0.927373,0 -1.831062,-0.03473 -2.71875,-0.0625 -0.05109,-1.155437 -0.0625,-2.365134 -0.0625,-3.59375 0,-0.628972 0.01741,-1.232249 0.03125,-1.84375 0.895269,-0.02827 1.783025,-0.0625 2.71875,-0.0625 z M 68.5625,70.6875 c -0.01243,0.60601 -0.03125,1.189946 -0.03125,1.8125 0,1.22431 0.01541,2.407837 0.0625,3.5625 -3.125243,-0.150329 -5.92077,-0.471558 -8.09375,-0.90625 -0.784983,-0.157031 -1.511491,-0.316471 -2.125,-0.5 -0.107878,-0.704096 -0.1875,-1.422089 -0.1875,-2.15625 0,-0.115714 0.02849,-0.228688 0.03125,-0.34375 0.643106,-0.20284 1.389577,-0.390377 2.25,-0.5625 2.166953,-0.433487 4.97905,-0.75541 8.09375,-0.90625 z m 8.3125,0.03125 c 3.075121,0.15271 5.824455,0.446046 7.96875,0.875 0.857478,0.171534 1.630962,0.360416 2.28125,0.5625 0.0027,0.114659 0,0.228443 0,0.34375 0,0.735827 -0.07914,1.450633 -0.1875,2.15625 -0.598568,0.180148 -1.29077,0.34562 -2.0625,0.5 -2.158064,0.431708 -4.932088,0.754666 -8.03125,0.90625 0.04709,-1.154663 0.0625,-2.33819 0.0625,-3.5625 0,-0.611824 -0.01924,-1.185379 -0.03125,-1.78125 z M 57.15625,72.5625 c 0.0023,0.572772 0.06082,1.131112 0.125,1.6875 -0.125327,-0.05123 -0.266577,-0.10497 -0.375,-0.15625 -0.396499,-0.187528 -0.665288,-0.387337 -0.8125,-0.53125 -0.147212,-0.143913 -0.15625,-0.182756 -0.15625,-0.1875 0,-0.0047 -0.02221,-0.07484 0.125,-0.21875 0.147212,-0.143913 0.447251,-0.312472 0.84375,-0.5 0.07123,-0.03369 0.171867,-0.06006 0.25,-0.09375 z m 31.03125,0 c 0.08201,0.03503 0.175941,0.05872 0.25,0.09375 0.396499,0.187528 0.665288,0.356087 0.8125,0.5 0.14725,0.14391 0.15625,0.21405 0.15625,0.21875 0,0.0047 -0.009,0.04359 -0.15625,0.1875 -0.147212,0.143913 -0.416001,0.343722 -0.8125,0.53125 -0.09755,0.04613 -0.233314,0.07889 -0.34375,0.125 0.06214,-0.546289 0.09144,-1.094215 0.09375,-1.65625 z m -29.5,3.625 c 0.479308,0.123125 0.983064,0.234089 1.53125,0.34375 2.301781,0.460458 5.229421,0.787224 8.46875,0.9375 0.167006,2.84339 0.46081,5.433176 0.875,7.5 0.115218,0.574942 0.245268,1.063612 0.375,1.5625 -5.463677,-1.028179 -9.833074,-5.091831 -11.25,-10.34375 z m 27.96875,0 C 85.247546,81.408945 80.919274,85.442932 75.5,86.5 c 0.126981,-0.490925 0.261959,-0.967174 0.375,-1.53125 0.41419,-2.066824 0.707994,-4.65661 0.875,-7.5 3.204493,-0.15162 6.088346,-0.480068 8.375,-0.9375 0.548186,-0.109661 1.051942,-0.220625 1.53125,-0.34375 z M 70.0625,77.53125 c 0.865391,0.02589 1.723666,0.03125 2.625,0.03125 0.912062,0 1.782843,-0.0048 2.65625,-0.03125 -0.165173,2.736408 -0.453252,5.207651 -0.84375,7.15625 -0.152345,0.760206 -0.322989,1.438994 -0.5,2.03125 -0.437447,0.03919 -0.895856,0.0625 -1.34375,0.0625 -0.414943,0 -0.812719,-0.02881 -1.21875,-0.0625 -0.177011,-0.592256 -0.347655,-1.271044 -0.5,-2.03125 -0.390498,-1.948599 -0.700644,-4.419842 -0.875,-7.15625 z m 1.75,10.28125 c 0.284911,0.01545 0.554954,0.03125 0.84375,0.03125 0.325029,0 0.648588,-0.01171 0.96875,-0.03125 -0.05999,0.148763 -0.127309,0.31046 -0.1875,0.4375 -0.18789,0.396562 -0.386962,0.696416 -0.53125,0.84375 -0.144288,0.147334 -0.181857,0.125 -0.1875,0.125 -0.0056,0 -0.07446,0.02233 -0.21875,-0.125 C 72.355712,88.946416 72.18789,88.646562 72,88.25 71.939809,88.12296 71.872486,87.961263 71.8125,87.8125 z",svgCompassOuterRing="M87.4250304,49 C86.1628208,69.9848029 69.1166553,86.7136515 48.0000096,87.4730701 L48,88 C48,88.8284271 47.3284271,89.5 46.5,89.5 C45.6715729,89.5 45,88.8284271 45,88 L45,87.4730704 C23.8833447,86.7136515 6.8371792,69.9848029 5.5749696,49 L5,49 C4.17157288,49 3.5,48.3284271 3.5,47.5 C3.5,46.6715729 4.17157288,46 5,46 L5.50298617,46 C5.76484958,24.0874661 23.216635,6.31032543 44.9999904,5.52692991 L45,5 C45,4.17157288 45.6715729,3.5 46.5,3.5 C47.3284271,3.5 48,4.17157288 48,5 L48,5.52692956 C69.783365,6.31032543 87.2351504,24.0874661 87.4970138,46 L88,46 C88.8284271,46 89.5,46.6715729 89.5,47.5 C89.5,48.3284271 88.8284271,49 88,49 L87.4250304,49 Z M84.4190746,49 L81,49 C80.1715729,49 79.5,48.3284271 79.5,47.5 C79.5,46.6715729 80.1715729,46 81,46 L84.4967778,46 C84.2355755,25.7444281 68.1261733,9.31030612 48,8.52906287 L48,12 C48,12.8284271 47.3284271,13.5 46.5,13.5 C45.6715729,13.5 45,12.8284271 45,12 L45,8.52906287 C24.8738267,9.31030612 8.7644245,25.7444281 8.50322217,46 L12,46 C12.8284271,46 13.5,46.6715729 13.5,47.5 C13.5,48.3284271 12.8284271,49 12,49 L8.58092544,49 C9.83614053,68.3272166 25.5405438,83.715574 45,84.4709371 L45,81 C45,80.1715729 45.6715729,79.5 46.5,79.5 C47.3284271,79.5 48,80.1715729 48,81 L48,84.4709371 C67.4594562,83.715574 83.1638595,68.3272166 84.4190746,49 Z",svgCompassRotationMarker="M 72.46875,22.03125 C 59.505873,22.050338 46.521615,27.004287 36.6875,36.875 L 47.84375,47.96875 C 61.521556,34.240041 83.442603,34.227389 97.125,47.90625 l 11.125,-11.125 C 98.401629,26.935424 85.431627,22.012162 72.46875,22.03125 z",svgReset="M 7.5,0 C 3.375,0 0,3.375 0,7.5 0,11.625 3.375,15 7.5,15 c 3.46875,0 6.375,-2.4375 7.21875,-5.625 l -1.96875,0 C 12,11.53125 9.9375,13.125 7.5,13.125 4.40625,13.125 1.875,10.59375 1.875,7.5 1.875,4.40625 4.40625,1.875 7.5,1.875 c 1.59375,0 2.90625,0.65625 3.9375,1.6875 l -3,3 6.5625,0 L 15,0 12.75,2.25 C 11.4375,0.84375 9.5625,0 7.5,0 z",Utils={},unprojectedScratch=new Cesium.Cartographic,rayScratch=new Cesium.Ray,svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg");svgElement.setAttribute("style","width:60px;height:60px;"),svgElement.setAttribute("viewBox","0 0 60 60");var circle=document.createElementNS("http://www.w3.org/2000/svg","circle");circle.setAttribute("cx","30"),circle.setAttribute("cy","30"),circle.setAttribute("r","22.6132903"),circle.setAttribute("style","stroke-opacity:0.6;stroke-width:14.904;stroke:#1C1C1C;fill-opacity:0.8;fill:#1C1C1C");var path=document.createElementNS("http://www.w3.org/2000/svg","path");path.setAttribute("d","M56.4032454,31.6129032 C55.5889166,45.1514857 44.5913905,55.9442913 30.9677481,56.4342388 L30.9677419,56.7741935 C30.9677419,57.3086627 30.5344691,57.7419355 30,57.7419355 C29.4655309,57.7419355 29.0322581,57.3086627 29.0322581,56.7741935 L29.0322581,56.434239 C15.4086095,55.9442913 4.41108336,45.1514857 3.59675458,31.6129032 L3.22580645,31.6129032 C2.69133734,31.6129032 2.25806452,31.1796304 2.25806452,30.6451613 C2.25806452,30.1106922 2.69133734,29.6774194 3.22580645,29.6774194 L3.55031366,29.6774194 C3.71925779,15.5403007 14.9784742,4.0711777 29.0322519,3.56576123 L29.0322581,3.22580645 C29.0322581,2.69133734 29.4655309,2.25806452 30,2.25806452 C30.5344691,2.25806452 30.9677419,2.69133734 30.9677419,3.22580645 L30.9677419,3.56576101 C45.0215258,4.0711777 56.2807422,15.5403007 56.4496863,29.6774194 L56.7741935,29.6774194 C57.3086627,29.6774194 57.7419355,30.1106922 57.7419355,30.6451613 C57.7419355,31.1796304 57.3086627,31.6129032 56.7741935,31.6129032 L56.4032454,31.6129032 Z M54.4639191,31.6129032 L52.2580645,31.6129032 C51.7235954,31.6129032 51.2903226,31.1796304 51.2903226,30.6451613 C51.2903226,30.1106922 51.7235954,29.6774194 52.2580645,29.6774194 L54.5140502,29.6774194 C54.3455326,16.6093084 43.9523699,6.00664911 30.9677419,5.50262121 L30.9677419,7.74193548 C30.9677419,8.2764046 30.5344691,8.70967742 30,8.70967742 C29.4655309,8.70967742 29.0322581,8.2764046 29.0322581,7.74193548 L29.0322581,5.50262121 C16.0476301,6.00664911 5.65446742,16.6093084 5.48594978,29.6774194 L7.74193548,29.6774194 C8.2764046,29.6774194 8.70967742,30.1106922 8.70967742,30.6451613 C8.70967742,31.1796304 8.2764046,31.6129032 7.74193548,31.6129032 L5.53608093,31.6129032 C6.34589712,44.0820752 16.4777702,54.0100478 29.0322581,54.4973788 L29.0322581,52.2580645 C29.0322581,51.7235954 29.4655309,51.2903226 30,51.2903226 C30.5344691,51.2903226 30.9677419,51.7235954 30.9677419,52.2580645 L30.9677419,54.4973788 C43.5222298,54.0100478 53.6541029,44.0820752 54.4639191,31.6129032 Z"),path.setAttribute("style","fill:#818181"),path.setAttribute("fill-rule","nonzero"),svgElement.appendChild(circle),svgElement.appendChild(path);var polygon=document.createElementNS("http://www.w3.org/2000/svg","polygon");polygon.setAttribute("points","22.5806452 30.3225806 38.0645161 30.3225806 30 49.0322581"),polygon.setAttribute("style","fill: #D8D8D8");var CompassPath=document.createElementNS("http://www.w3.org/2000/svg","path");CompassPath.setAttribute("d","M38.0645161,30.3225806 C35.2492669,30.7526882 32.6686217,30.9677419 30.3225806,30.9677419 C27.9765396,30.9677419 25.3958944,30.7526882 22.5806452,30.3225806 L30,10.3225806 L38.0645161,30.3225806 Z"),CompassPath.setAttribute("style","fill:#FF0000"),svgElement.appendChild(polygon),svgElement.appendChild(CompassPath),Utils.getCameraFocus=function(e,t,i){var o=e.scene,a=o.camera;if(o.mode!=Cesium.SceneMode.MORPHING&&(Cesium.defined(i)||(i=new Cesium.Cartesian3),i=Cesium.defined(e.trackedEntity)?e.trackedEntity.position.getValue(e.clock.currentTime,i):(rayScratch.origin=a.positionWC,rayScratch.direction=a.directionWC,o.globe.pick(rayScratch,o,i)),Cesium.defined(i)))return o.mode==Cesium.SceneMode.SCENE2D||o.mode==Cesium.SceneMode.COLUMBUS_VIEW?(i=a.worldToCameraCoordinatesPoint(i,i),t&&(i=o.globe.ellipsoid.cartographicToCartesian(o.mapProjection.unproject(i,unprojectedScratch),i))):t||(i=a.worldToCameraCoordinatesPoint(i,i)),i};var loadView=function(e,t,i){t=Cesium.getElement(t);var o,a=createFragmentFromTemplate(e),n=[];for(o=0;o<a.childNodes.length;++o)n.push(a.childNodes[o]);for(t.appendChild(a),o=0;o<n.length;++o){var s=n[o];1!==s.nodeType&&8!==s.nodeType||Cesium.knockout.applyBindings(i,s)}return n},createFragmentFromTemplate=function(e){var t=document.createElement("div");t.innerHTML=e;for(var i=document.createDocumentFragment();t.firstChild;)i.appendChild(t.firstChild);return i},UserInterfaceControl=function(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("terria is required");this._terria=e,this.name="Unnamed Control",this.text=void 0,this.svgIcon=void 0,this.svgHeight=void 0,this.svgWidth=void 0,this.cssClass=void 0,this.isActive=!1,Cesium.knockout.track(this,["name","svgIcon","svgHeight","svgWidth","cssClass","isActive"])};Cesium.defineProperties(UserInterfaceControl.prototype,{terria:{get:function(){return this._terria}},hasText:{get:function(){return Cesium.defined(this.text)&&"string"==typeof this.text}}}),UserInterfaceControl.prototype.activate=function(){throw new Cesium.DeveloperError("activate must be implemented in the derived class.")};var NavigationControl=function(e){UserInterfaceControl.apply(this,arguments)};NavigationControl.prototype=UserInterfaceControl.prototype;var DistanceLegendViewModel=function(e){if(!Cesium.defined(e)||!Cesium.defined(e.terria))throw new DeveloperError("options.terria is required.");this.terria=e.terria,this._removeSubscription=void 0,this._lastLegendUpdate=void 0,this.eventHelper=new Cesium.EventHelper,this.distanceLabel=void 0,this.barWidth=void 0,this.enableDistanceLegend=!Cesium.defined(e.enableDistanceLegend)||e.enableDistanceLegend,Cesium.knockout.track(this,["distanceLabel","barWidth"]),this.eventHelper.add(this.terria.afterWidgetChanged,function(){Cesium.defined(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0)},this);var o=this;function t(){if(Cesium.defined(o.terria)){var e=o.terria.scene;o._removeSubscription=e.postRender.addEventListener(function(){updateDistanceLegendCesium(this,e)},o)}else if(Cesium.defined(o.terria.leaflet)){var t=o.terria.leaflet.map,i=function(){updateDistanceLegendLeaflet(o,t)};o._removeSubscription=function(){t.off("zoomend",i),t.off("moveend",i)},t.on("zoomend",i),t.on("moveend",i),updateDistanceLegendLeaflet(o,t)}}t(),this.eventHelper.add(this.terria.afterWidgetChanged,function(){t()},this)};DistanceLegendViewModel.prototype.destroy=function(){this.eventHelper.removeAll()},DistanceLegendViewModel.prototype.show=function(e){var t;t=this.enableDistanceLegend?'<div class="distance-legend" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label" data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar" data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>':'<div class="distance-legend"  style="display: none;" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label"  data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar"  data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>',loadView(t,e,this)},DistanceLegendViewModel.create=function(e){var t=new DistanceLegendViewModel(e);return t.show(e.container),t};var geodesic=new Cesium.EllipsoidGeodesic,distances=[1,2,3,5,10,20,30,50,100,200,300,500,1e3,2e3,3e3,5e3,1e4,2e4,3e4,5e4,1e5,2e5,3e5,5e5,1e6,2e6,3e6,5e6,1e7,2e7,3e7,5e7];function updateDistanceLegendCesium(e,t){if(!e.enableDistanceLegend)return e.barWidth=void 0,void(e.distanceLabel=void 0);var i=Cesium.getTimestamp();if(!(i<e._lastLegendUpdate+250)){e._lastLegendUpdate=i;var o=t.canvas.clientWidth,a=t.canvas.clientHeight,n=t.camera.getPickRay(new Cesium.Cartesian2(o/2|0,a-1)),s=t.camera.getPickRay(new Cesium.Cartesian2(1+o/2|0,a-1)),r=t.globe,d=r.pick(n,t),c=r.pick(s,t);if(!Cesium.defined(d)||!Cesium.defined(c))return e.barWidth=void 0,void(e.distanceLabel=void 0);var l=r.ellipsoid.cartesianToCartographic(d),m=r.ellipsoid.cartesianToCartographic(c);geodesic.setEndPoints(l,m);for(var u,v,C=geodesic.surfaceDistance,h=distances.length-1;!Cesium.defined(u)&&0<=h;--h)distances[h]/C<100&&(u=distances[h]);if(Cesium.defined(u))v=1e3<=u?(u/1e3).toString()+" km":u.toString()+" m",e.barWidth=u/C|0,e.distanceLabel=v;else e.barWidth=void 0,e.distanceLabel=void 0}}function updateDistanceLegendLeaflet(e,t){var i=t.getSize().y/2,o=t.containerPointToLatLng([0,i]).distanceTo(t.containerPointToLatLng([100,i])),a=leaflet.control.scale()._getRoundNum(o),n=a<1e3?a+" m":a/1e3+" km";e.barWidth=a/o*100,e.distanceLabel=n}var NavigationViewModel=function(e){this.terria=e.terria,this.eventHelper=new Cesium.EventHelper,this.enableZoomControls=!Cesium.defined(e.enableZoomControls)||e.enableZoomControls,this.enableCompass=!Cesium.defined(e.enableCompass)||e.enableCompass,this.controls=e.controls,Cesium.defined(this.controls)||(this.controls=[new ZoomNavigationControl(this.terria,!0),new ZoomNavigationControl(this.terria,!1)]),this.showCompass=Cesium.defined(this.terria)&&this.enableCompass,this.heading=this.showCompass?this.terria.scene.camera.heading:0,this.showControls=Cesium.defined(this.terria)&&this.enableZoomControls,this.isOrbiting=!1,this.isZooming=!1,this.orbitCursorAngle=0,this.orbitCursorOpacity=0,this.orbitLastTimestamp=0,this.orbitFrame=void 0,this.orbitIsLook=!1,this.orbitMouseMoveFunction=void 0,this.orbitMouseUpFunction=void 0,this.isRotating=!1,this.rotateInitialCursorAngle=void 0,this.rotateFrame=void 0,this.rotateIsLook=!1,this.rotateMouseMoveFunction=void 0,this.rotateMouseUpFunction=void 0,this._unsubcribeFromPostRender=void 0,Cesium.knockout.track(this,["controls","showCompass","showControls","heading","isOrbiting","isZooming","orbitCursorAngle","isRotating"]);var t=this;function i(){Cesium.defined(t.terria)?(t._unsubcribeFromPostRender&&(t._unsubcribeFromPostRender(),t._unsubcribeFromPostRender=void 0),t.showControls=t.enableZoomControls,t.showCompass=t.enableCompass,t._unsubcribeFromPostRender=t.terria.scene.postRender.addEventListener(function(){t.heading=t.terria.scene.camera.heading})):(t._unsubcribeFromPostRender&&(t._unsubcribeFromPostRender(),t._unsubcribeFromPostRender=void 0),t.showCompass=!1,t.showControls=!1)}this.eventHelper.add(this.terria.afterWidgetChanged,i,this),i()};NavigationViewModel.prototype.destroy=function(){this.eventHelper.removeAll()},NavigationViewModel.prototype.show=function(e){var t;this.enableZoomControls&&this.enableCompass?t='<div class="compass" title="" data-bind="visible: showCompass, event: { mousedown: handleMouseDown, click: handleDoubleClick }">'+" <div class=\"compass-rotation-marker\" data-bind=\"visible: isOrbiting, style: { transform: 'rotate(-' + orbitCursorAngle + 'rad)', '-webkit-transform': 'rotate(-' + orbitCursorAngle + 'rad)', opacity: orbitCursorOpacity }, cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }\"></div> <div class=\"compass-outer-ring\" title=\"\" data-bind=\"style: { transform: 'rotate(-' + heading + 'rad)', '-webkit-transform': 'rotate(-' + heading + 'rad)' }\"></div></div><div class=\"navigation-controls\" data-bind=\"visible: showControls\">\x3c!-- ko foreach: controls --\x3e<div data-bind=\" event: { mousedown: activate},attr: { title: $data.name }, css: { 'navigation-control-icon-active': isActive },css: $root.isLastControl($data) ? 'navigation-control-last' : 'navigation-control' \">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind=\"text: $data.text, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  <div data-bind=\"cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e</div>":!this.enableZoomControls&&this.enableCompass?t='<div class="compass" title="Drag outer ring: rotate view. Drag inner gyroscope: free orbit.Double-click: reset view.TIP: You can also free orbit by holding the CTRL key and dragging the map." data-bind="visible: showCompass, event: { mousedown: handleMouseDown, dblclick: handleDoubleClick }"> <div class="compass-rotation-marker" data-bind="visible: isOrbiting, style: { transform: \'rotate(-\' + orbitCursorAngle + \'rad)\', \'-webkit-transform\': \'rotate(-\' + orbitCursorAngle + \'rad)\', opacity: orbitCursorOpacity }, cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }"></div> <div class="compass-outer-ring" title="Click and drag to rotate the camera" data-bind="style: { transform: \'rotate(-\' + heading + \'rad)\', \'-webkit-transform\': \'rotate(-\' + heading + \'rad)\' }, cesiumSvgPath: { path: svgCompassOuterRing, width: 145, height: 145 }"></div> <div class="compass-gyro-background"></div> <div class="compass-gyro" data-bind="cesiumSvgPath: { path: svgCompassGyro, width: 145, height: 145 }, css: { \'compass-gyro-active\': isOrbiting }"></div></div><div class="navigation-controls"  style="display: none;" >\x3c!-- ko foreach: controls --\x3e<div data-bind="click: activate, attr: { title: $data.name }, css: $root.isLastControl($data) ? \'navigation-control-last\' : \'navigation-control\' ">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind="text: $data.text, css: $data.isActive ?  \'navigation-control-icon-active \' + $data.cssClass : $data.cssClass"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  <div data-bind="cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  \'navigation-control-icon-active \' + $data.cssClass : $data.cssClass"></div>  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e</div>':this.enableZoomControls&&!this.enableCompass?t='<div class="compass"  style="display: none;" title="Drag outer ring: rotate view. Drag inner gyroscope: free orbit.Double-click: reset view.TIP: You can also free orbit by holding the CTRL key and dragging the map." data-bind="visible: showCompass, event: { mousedown: handleMouseDown, dblclick: handleDoubleClick }"><div class="compass-outer-ring-background"></div>'+" <div class=\"compass-rotation-marker\" data-bind=\"visible: isOrbiting, style: { transform: 'rotate(-' + orbitCursorAngle + 'rad)', '-webkit-transform': 'rotate(-' + orbitCursorAngle + 'rad)', opacity: orbitCursorOpacity }, cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }\"></div> <div class=\"compass-outer-ring\" title=\"Click and drag to rotate the camera\" data-bind=\"style: { transform: 'rotate(-' + heading + 'rad)', '-webkit-transform': 'rotate(-' + heading + 'rad)' }, cesiumSvgPath: { path: svgCompassOuterRing, width: 145, height: 145 }\"></div> <div class=\"compass-gyro-background\"></div> <div class=\"compass-gyro\" data-bind=\"cesiumSvgPath: { path: svgCompassGyro, width: 145, height: 145 }, css: { 'compass-gyro-active': isOrbiting }\"></div></div><div class=\"navigation-controls\"    >\x3c!-- ko foreach: controls --\x3e<div data-bind=\"click: activate, attr: { title: $data.name }, css: $root.isLastControl($data) ? 'navigation-control-last' : 'navigation-control' \">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind=\"text: $data.text, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  <div data-bind=\"cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e</div>":this.enableZoomControls||this.enableCompass||(t='<div class="compass"  style="display: none;" title="拖动圆环:旋转视图. Drag inner gyroscope: free orbit.Double-click: reset view." data-bind="visible: showCompass, event: { mousedown: handleMouseDown, dblclick: handleDoubleClick }"><div class="compass-outer-ring-background"></div> <div class="compass-rotation-marker" data-bind="visible: isOrbiting, style: { transform: \'rotate(-\' + orbitCursorAngle + \'rad)\', \'-webkit-transform\': \'rotate(-\' + orbitCursorAngle + \'rad)\', opacity: orbitCursorOpacity }, cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }"></div> <div class="compass-outer-ring" title="Click and drag to rotate the camera" data-bind="style: { transform: \'rotate(-\' + heading + \'rad)\', \'-webkit-transform\': \'rotate(-\' + heading + \'rad)\' }, cesiumSvgPath: { path: svgCompassOuterRing, width: 145, height: 145 }"></div> <div class="compass-gyro-background"></div> <div class="compass-gyro" data-bind="cesiumSvgPath: { path: svgCompassGyro, width: 145, height: 145 }, css: { \'compass-gyro-active\': isOrbiting }"></div></div><div class="navigation-controls"   style="display: none;" >\x3c!-- ko foreach: controls --\x3e<div data-bind="click: activate, attr: { title: $data.name }, css: $root.isLastControl($data) ? \'navigation-control-last\' : \'navigation-control\' ">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind="text: $data.text, css: $data.isActive ?  \'navigation-control-icon-active \' + $data.cssClass : $data.cssClass"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  <div data-bind="cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  \'navigation-control-icon-active \' + $data.cssClass : $data.cssClass"></div>  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e</div>'),loadView(t,e,this),document.querySelector(".compass-outer-ring").appendChild(svgElement)},NavigationViewModel.prototype.add=function(e){this.controls.push(e)},NavigationViewModel.prototype.remove=function(e){this.controls.remove(e)},NavigationViewModel.prototype.isLastControl=function(e){return e===this.controls[this.controls.length-1]};var vectorScratch=new Cesium.Cartesian2;NavigationViewModel.prototype.handleMouseDown=function(e,t){if(this.terria.scene.mode===Cesium.SceneMode.MORPHING)return!0;var i=t.currentTarget,o=t.currentTarget.getBoundingClientRect(),a=o.width/2,n=new Cesium.Cartesian2((o.right-o.left)/2,(o.bottom-o.top)/2),s=new Cesium.Cartesian2(t.clientX-o.left,t.clientY-o.top),r=Cesium.Cartesian2.subtract(s,n,vectorScratch),d=Cesium.Cartesian2.magnitude(r)/a;if(d<50/145)orbit(this,i,r);else{if(!(d<1))return!0;rotate(this,i,r)}};var oldTransformScratch=new Cesium.Matrix4,newTransformScratch=new Cesium.Matrix4,centerScratch=new Cesium.Cartesian3;NavigationViewModel.prototype.handleDoubleClick=function(e,t){var i=e.terria.scene,o=i.camera,a=i.screenSpaceCameraController;if(i.mode==Cesium.SceneMode.MORPHING||!a.enableInputs)return!0;if((i.mode!=Cesium.SceneMode.COLUMBUS_VIEW||a.enableTranslate)&&(i.mode!=Cesium.SceneMode.SCENE3D&&i.mode!=Cesium.SceneMode.COLUMBUS_VIEW||a.enableLook)){var n=Utils.getCameraFocus(e.terria,!0,centerScratch);if(Cesium.defined(n)){var s=i.globe.ellipsoid.cartographicToCartesian(o.positionCartographic,new Cesium.Cartesian3),r=i.globe.ellipsoid.geodeticSurfaceNormal(n),d=new Cesium.BoundingSphere(n,0);o.flyToBoundingSphere(d,{offset:new Cesium.HeadingPitchRange(0,Cesium.Math.PI_OVER_TWO-Cesium.Cartesian3.angleBetween(r,o.directionWC),Cesium.Cartesian3.distance(s,n)),duration:1.5})}else this.controls[1].resetView()}},NavigationViewModel.create=function(e){var t=new NavigationViewModel(e);return t.show(e.container),t};var zoomCVWindowPos=new Cesium.Cartesian2,movement={startPosition:new Cesium.Cartesian2,endPosition:new Cesium.Cartesian2};function orbit(r,a,e){var d=r.terria.scene,c=d.screenSpaceCameraController;if(d.mode!=Cesium.SceneMode.MORPHING&&c.enableInputs){switch(d.mode){case Cesium.SceneMode.COLUMBUS_VIEW:if(c.enableLook)break;if(!c.enableTranslate||!c.enableTilt)return;break;case Cesium.SceneMode.SCENE3D:if(c.enableLook)break;if(!c.enableTilt||!c.enableRotate)return;break;case Cesium.SceneMode.SCENE2D:if(!c.enableTranslate)return}document.removeEventListener("mousemove",r.orbitMouseMoveFunction,!1),document.removeEventListener("mouseup",r.orbitMouseUpFunction,!1),Cesium.defined(r.orbitTickFunction)&&r.terria.clock.onTick.removeEventListener(r.orbitTickFunction),r.orbitMouseMoveFunction=void 0,r.orbitMouseUpFunction=void 0,r.orbitTickFunction=void 0,r.isOrbiting=!0,r.orbitLastTimestamp=Cesium.getTimestamp();var l=d.camera;if(Cesium.defined(r.terria.trackedEntity))r.orbitFrame=void 0,r.orbitIsLook=!1;else{var t=Utils.getCameraFocus(r.terria,!0,centerScratch);Cesium.defined(t)?(r.orbitFrame=Cesium.Transforms.eastNorthUpToFixedFrame(t,d.globe.ellipsoid,newTransformScratch),r.orbitIsLook=!1):(r.orbitFrame=Cesium.Transforms.eastNorthUpToFixedFrame(l.positionWC,d.globe.ellipsoid,newTransformScratch),r.orbitIsLook=!0)}r.orbitTickFunction=function(e){var t=Cesium.getTimestamp(),i=(t-r.orbitLastTimestamp)*(2.5*(r.orbitCursorOpacity-.5)/10),o=r.orbitCursorAngle+Cesium.Math.PI_OVER_TWO,a=Math.cos(o)*i,n=Math.sin(o)*i;if(d.mode==Cesium.SceneMode.SCENE2D)l.move(new Cesium.Cartesian3(a,n,0),Math.max(d.canvas.clientWidth,d.canvas.clientHeight)/100*l.positionCartographic.height*i);else{var s=d.canvas;zoomCVWindowPos.x=s.clientWidth/2,zoomCVWindowPos.y=s.clientHeight/2,movement.startPosition.x=zoomCVWindowPos.x,movement.startPosition.y=zoomCVWindowPos.y,movement.endPosition.x=zoomCVWindowPos.x+a,movement.endPosition.y=zoomCVWindowPos.y+n,c.tilt3D(zoomCVWindowPos,movement)}r.orbitLastTimestamp=t},r.orbitMouseMoveFunction=function(e){var t=a.getBoundingClientRect(),i=new Cesium.Cartesian2((t.right-t.left)/2,(t.bottom-t.top)/2),o=new Cesium.Cartesian2(e.clientX-t.left,e.clientY-t.top);n(Cesium.Cartesian2.subtract(o,i,vectorScratch),t.width)},r.orbitMouseUpFunction=function(e){r.isOrbiting=!1,document.removeEventListener("mousemove",r.orbitMouseMoveFunction,!1),document.removeEventListener("mouseup",r.orbitMouseUpFunction,!1),Cesium.defined(r.orbitTickFunction)&&r.terria.clock.onTick.removeEventListener(r.orbitTickFunction),r.orbitMouseMoveFunction=void 0,r.orbitMouseUpFunction=void 0,r.orbitTickFunction=void 0},document.addEventListener("mouseup",r.orbitMouseUpFunction,!1),r.terria.clock.onTick.addEventListener(r.orbitTickFunction),n(e,a.getBoundingClientRect().width)}function n(e,t){var i=Math.atan2(-e.y,e.x);r.orbitCursorAngle=Cesium.Math.zeroToTwoPi(i-Cesium.Math.PI_OVER_TWO);var o=Cesium.Cartesian2.magnitude(e),a=t/2,n=Math.min(o/a,1),s=.5*n*n+.5;r.orbitCursorOpacity=s}}function rotate(l,m,e){if(l.terria.options.enableCompassOuterRing=!Cesium.defined(l.terria.options.enableCompassOuterRing)||l.terria.options.enableCompassOuterRing,l.terria.options.enableCompassOuterRing){var t,i=l.terria.scene,o=i.camera,a=i.screenSpaceCameraController;if(i.mode==Cesium.SceneMode.MORPHING||i.mode==Cesium.SceneMode.SCENE2D||!a.enableInputs)return;if(!a.enableLook&&(i.mode==Cesium.SceneMode.COLUMBUS_VIEW||i.mode==Cesium.SceneMode.SCENE3D&&!a.enableRotate))return;if(document.removeEventListener("mousemove",l.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",l.rotateMouseUpFunction,!1),l.rotateMouseMoveFunction=void 0,l.rotateMouseUpFunction=void 0,l.isRotating=!0,l.rotateInitialCursorAngle=Math.atan2(-e.y,e.x),Cesium.defined(l.terria.trackedEntity))l.rotateFrame=void 0,l.rotateIsLook=!1;else{var n=Utils.getCameraFocus(l.terria,!0,centerScratch);Cesium.defined(n)&&(i.mode!=Cesium.SceneMode.COLUMBUS_VIEW||a.enableLook||a.enableTranslate)?(l.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(n,i.globe.ellipsoid,newTransformScratch),l.rotateIsLook=!1):(l.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(o.positionWC,i.globe.ellipsoid,newTransformScratch),l.rotateIsLook=!0)}Cesium.defined(l.rotateFrame)&&(t=Cesium.Matrix4.clone(o.transform,oldTransformScratch),o.lookAtTransform(l.rotateFrame)),l.rotateInitialCameraAngle=-o.heading,Cesium.defined(l.rotateFrame)&&o.lookAtTransform(t),l.rotateMouseMoveFunction=function(e){var t,i=m.getBoundingClientRect(),o=new Cesium.Cartesian2((i.right-i.left)/2,(i.bottom-i.top)/2),a=new Cesium.Cartesian2(e.clientX-i.left,e.clientY-i.top),n=Cesium.Cartesian2.subtract(a,o,vectorScratch),s=Math.atan2(-n.y,n.x)-l.rotateInitialCursorAngle,r=Cesium.Math.zeroToTwoPi(l.rotateInitialCameraAngle-s),d=l.terria.scene.camera;Cesium.defined(l.rotateFrame)&&(t=Cesium.Matrix4.clone(d.transform,oldTransformScratch),d.lookAtTransform(l.rotateFrame));var c=-d.heading;d.rotateRight(r-c),Cesium.defined(l.rotateFrame)&&d.lookAtTransform(t)},l.rotateMouseUpFunction=function(e){l.isRotating=!1,document.removeEventListener("mousemove",l.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",l.rotateMouseUpFunction,!1),l.rotateMouseMoveFunction=void 0,l.rotateMouseUpFunction=void 0},document.addEventListener("mouseup",l.rotateMouseUpFunction,!1)}}var ResetViewNavigationControl=function(e){NavigationControl.apply(this,arguments),this.name="重置视角",this.svgIcon=svgReset,this.svgHeight=15,this.svgWidth=15,this.cssClass="navigation-control-icon-reset"};ResetViewNavigationControl.prototype=Object.create(NavigationControl.prototype),ResetViewNavigationControl.prototype.resetView=function(){var e=this.terria.scene;if(e.screenSpaceCameraController.enableInputs){this.isActive=!0;var t=e.camera;if(Cesium.defined(this.terria.trackedEntity)){var i=this.terria.trackedEntity;this.terria.trackedEntity=void 0,this.terria.trackedEntity=i}else if(this.terria.options.defaultResetView){if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof Cartographic)t.flyTo({destination:e.globe.ellipsoid.cartographicToCartesian(this.terria.options.defaultResetView)});else if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof Rectangle)try{Rectangle.validate(this.terria.options.defaultResetView),t.flyTo({destination:this.terria.options.defaultResetView})}catch(e){console.log("Cesium-navigation/ResetViewNavigationControl:   options.defaultResetView Cesium rectangle is  invalid!")}}else"function"==typeof t.flyHome?t.flyHome(1):t.flyTo({destination:Camera.DEFAULT_VIEW_RECTANGLE,duration:1});this.isActive=!1}},ResetViewNavigationControl.prototype.activate=function(){this.resetView()};var ZoomNavigationControl=function(e,t){NavigationControl.apply(this,arguments),this.name=t?"放大":"缩小",this.text=t?"+":"-",this.cssClass="navigation-control-icon-zoom-"+(t?"in":"out"),this.relativeAmount=2,t&&(this.relativeAmount=1/this.relativeAmount)};ZoomNavigationControl.prototype.relativeAmount=1,ZoomNavigationControl.prototype=Object.create(NavigationControl.prototype),ZoomNavigationControl.prototype.activate=function(){this.zoom(this.relativeAmount)};var cartesian3Scratch=new Cesium.Cartesian3;ZoomNavigationControl.prototype.zoom=function(e){if(this.isActive=!0,Cesium.defined(this.terria)){var t=this.terria.scene,i=t.screenSpaceCameraController;if(!i.enableInputs||!i.enableZoom)return;var o=t.camera;switch(t.mode){case Cesium.SceneMode.MORPHING:break;case Cesium.SceneMode.SCENE2D:o.zoomIn(o.positionCartographic.height*(1-this.relativeAmount));break;default:zoomInOrOut(this,t,i,e)}}this.isActive=!1};var zoomCVWindowRay=new Cesium.Ray,scratchRayIntersection=new Cesium.Cartesian3,pickGlobeScratchRay=new Cesium.Ray,zoom3DUnitPosition=new Cesium.Cartesian3,cameraToObjectRay=new Cesium.Ray;function zoomInOrOut(t,y,e,r){function M(e,t){var i=y.camera.getPickRay(e,pickGlobeScratchRay),o=y.screenSpaceCameraController._globe.pick(i,y,scratchRayIntersection);return Cesium.Cartesian3.clone(o,t)}document.removeEventListener("mouseup",t.orbitMouseUpFunction,!1),t.zoomMouseUpFunction=void 0,t.zoomTickFunction=function(e){var t=y.canvas;zoomCVWindowPos.x=t.clientWidth/2,zoomCVWindowPos.y=t.clientHeight/2,movement.startPosition.x=0,movement.startPosition.y=0,movement.endPosition.x=0,movement.endPosition.y=1-r;var i=zoomCVWindowPos;i.x=t.clientWidth/2,i.y=t.clientHeight/2;var o=y.camera.getPickRay(i,zoomCVWindowRay);if(y.mode===Cesium.SceneMode.SCENE3D){var a,n=M(i);Cesium.defined(n)&&(a=Cesium.Cartesian3.distance(o.origin,n));var s=Cesium.Cartesian3.normalize(y.camera.position,zoom3DUnitPosition);!function(e,t){var i=1;Cesium.defined(t)&&(i=Cesium.Math.clamp(Math.abs(t),.1,1));var o=y.screenSpaceCameraController.minimumZoomDistance*i,a=y.screenSpaceCameraController.maximumZoomDistance,n=void 0;n=5e3<e&&e<=1e4?e/90:1e4<e&&e<=2e4?e/80:2e4<e&&e<=3e4?e/70:3e4<e?e/60:e/100;var s=movement.endPosition.y-movement.startPosition.y;if(s<0?(n=-n,document.getElementsByClassName("navigation-control-last")[0].style.background="rgba(104, 173, 254, .8)"):document.getElementsByClassName("navigation-control")[0].style.background="rgba(104, 173, 254, .8)",!(0<n&&Math.abs(e-o)<1||0<n&&Math.abs(e-o)<1||n<0&&Math.abs(e-a)<1)){e-n<o?n=e-o-1:a<e-n&&(n=e-a);var r=M(zoomCVWindowPos),d=Cesium.Cartesian3.clone(y.camera.position),c=Cesium.Cartesian3.clone(y.camera.right),l=Cesium.Cartesian3.clone(y.camera.direction),m=Cesium.Cartesian3.clone(y.camera.up),u=r,v=new Cesium.Cartesian3;if(Cesium.defined(u)){Cesium.Cartesian3.subtract(u,y.camera.position,v),Cesium.Cartesian3.normalize(v,v);var C=Cesium.Cartesian3.clone(y.camera.right),h=Cesium.Cartesian3.dot(v,C),g=new Cesium.Cartesian3;Cesium.Cartesian3.multiplyByScalar(C,h,g);var p=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(v,g,p),Cesium.Cartesian3.normalize(p,p),cameraToObjectRay.origin=y.camera.positionWC,cameraToObjectRay.direction=y.camera.directionWC;var b=void 0;b=y.globe.pick(cameraToObjectRay,y,b);var f=void 0;if(Cesium.defined(b)){var w=Cesium.SceneTransforms.wgs84ToWindowCoordinates(y,b);Cesium.defined(w)&&(f=y.pickGlobe(w))}if(!Cesium.defined(f))return;y.camera.move(p,n),38268822<Cesium.Cartesian3.distance(new Cesium.Cartesian3(y.camera.position.x,y.camera.position.y,y.camera.position.z),new Cesium.Cartesian3(0,0,0))&&s<0?(y.camera.position=d,y.camera.right=c,y.camera.direction=l,y.camera.up=m):Cesium.Cartesian3.distance(y.camera.position,f)<1&&(y.camera.position=d,y.camera.right=c,y.camera.direction=l,y.camera.up=m)}}}(a,Cesium.Cartesian3.dot(s,y.camera.direction))}},t.zoomMouseUpFunction=function(e){document.removeEventListener("mouseup",t.zoomMouseUpFunction,!1),t.terria.clock.onTick.removeEventListener(t.zoomTickFunction),t.zoomMouseUpFunction=void 0,t.zoomTickFunction=void 0,document.getElementsByClassName("navigation-control-last")[0].style.background="rgba(27, 28, 27, .8)",document.getElementsByClassName("navigation-control")[0].style.background="rgba(27, 28, 27, .8)"},document.addEventListener("mouseup",t.zoomMouseUpFunction,!1),t.terria.clock.onTick.addEventListener(t.zoomTickFunction)}function viewerNavigationMixin(e,t){if(!Cesium.defined(e))throw new Cesium.DeveloperError("viewer is required.");var i;init(e,t).addOnDestroyListener((i=e,function(){delete i.navigation})),Cesium.defineProperties(e,{navigation:{configurable:!0,get:function(){return e.cesiumWidget.navigation}}})}!function(s){var t=function(e,t,i,o,a,n){this._center=e,this._radiusMedian=t,this._radiusSubCircle=i,this._durationMedianCircle=o,this._durationSubCircle=a,s.defined(n)||(n=s.Ellipsoid.WGS84),this._ellipsoid=n,this._definitionChanged=new s.Event};s.defineProperties(t.prototype,{isConstant:{get:function(){return 0==this._radiusMedian&&0==this._radiusSubCircle}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return s.ReferenceFrame.FIXED}}}),t.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,s.ReferenceFrame.FIXED,t)};var n=new s.Cartographic;t.prototype.getValueInReferenceFrame=function(e,t,i){var o=s.JulianDate.toDate(e).getTime(),a=this._radiusMedian+this._radiusSubCircle*Math.sin(2*Math.PI*(o/this._durationSubCircle));return n.latitude=this._center.latitude+a*Math.cos(2*Math.PI*(o/this._durationMedianCircle)),n.longitude=this._center.longitude+a*Math.sin(2*Math.PI*(o/this._durationMedianCircle)),n.height=this._center.height,i=this._ellipsoid.cartographicToCartesian(n,i),t==s.ReferenceFrame.FIXED?i:s.PositionProperty.convertToReferenceFrame(e,i,s.ReferenceFrame.FIXED,t,i)},t.prototype.equals=function(e){return e instanceof t&&this._center.equals(e._center)&&this._radiusMedian==e._radiusMedian&&this._radiusSubCircle==e._radiusSubCircle&&this._durationMedianCircle==e._durationMedianCircle&&this._durationSubCircle==e._durationSubCircle&&this._ellipsoid.equals(e._ellipsoid)},s.SpirographPositionProperty=t}(Cesium),viewerNavigationMixin.mixinWidget=function(e,t){return init.apply(void 0,arguments)};var init=function(e,t){var i,o=new CesiumNavigation(e,t),a=Cesium.defined(e.cesiumWidget)?e.cesiumWidget:e;return Cesium.defineProperties(a,{navigation:{configurable:!0,get:function(){return o}}}),o.addOnDestroyListener((i=a,function(){delete i.navigation})),o};