"use strict";function PluginsManager(e,i){i.extend(viewerLayersManagerMixin),i.extend(viewerPlacePointMixin),i.extend(viewerPlacePolylineMixin),i.extend(viewerPlacePolygonMixin),i.extend(viewerPlaceModelMixin),i.extend(viewerClassificationEditerMixin),i.extend(viewerFlightPathMixin),i.extend(viewerMeasureMixin),i.extend(viewerGeocodeMixin),i.extend(viewerNavigationMixin);var n=new PluginsManagerViewMoodel(i),t=document.createElement("div");t.classList.add("dataEarth-viewer-pluginsManager"),t.setAttribute("data-bind",'style: { top: "10px"}, css: { expend: isExpend}'),e.appendChild(t),this._container=e,this._element=t,this._viewModel=n;var l='      <ul>        <li  data-bind="click: toggleLayesManager, css: { current: activeLayerManager }" title="图层管理"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'sceneInfomation\'), visible: !sceneServiceType" title="场景信息"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'sceneManager\'), visible: !sceneServiceType" title="场景管理"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'pluginControl\'), visible: !sceneServiceType" title="插件管理"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'flightPath\'), visible: !sceneServiceType || (sceneServiceType && clientPlugins.plugin_flight)" title="飞行管理"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'classificationEditer\'), visible: !sceneServiceType || (sceneServiceType && clientPlugins.plugin_classification)" title="场景单体化"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'placePoint\'), visible: sceneServiceType && clientPlugins.plugin_point" title="添加标注"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'placePolyline\'), visible: sceneServiceType && clientPlugins.plugin_polyline" title="绘制线"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'placePolygon\'), visible: sceneServiceType && clientPlugins.plugin_polygon" title="绘制面"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'placeModel\'), visible: sceneServiceType && clientPlugins.plugin_model" title="添加模型"></li>        <li  data-bind="click: pluginsSwitch.bind($data, \'measure\'), visible: !sceneServiceType || (sceneServiceType && clientPlugins.plugin_measure)" title="场景量算"></li>      </ul>      <a class="togglePlugins" data-bind="click: toggleExpend,css: { expend: isExpend}"><img src="'+i._basePath+'/Plugins/assets/rightArrow.svg"/></a> ';t.innerHTML=l,Cesium.knockout.applyBindings(n,t)}function PluginsManagerViewMoodel(e){var i=this;this._viewer=e,this._onCreatedEvent=new Cesium.Event,Cesium.knockout.track(this,["activeLayerManager","currentTab","sceneServiceType","clientPlugins","isExpend"]),this.activeLayerManager=!1,this.currentTab="",this.sceneServiceType=void 0,this.isExpend=!0,this.clientPlugins={plugin_measure:!0,plugin_flight:!0,plugin_polyline:!1,plugin_polygon:!1,plugin_point:!1,plugin_model:!1,plugin_classification:!0,plugin_poi:!0,plugin_navigation:!0},this.toggleExpend=function(){this.isExpend=!this.isExpend},this._viewer.layersManager.viewModel.onCreatedEvent.addEventListener(function(e){i.destroyAllPlugins(),"addPoint"===e.type?i._viewer.placePoint.viewModel.Show():"addPolyline"===e.type?i._viewer.placePolyline.viewModel.Show():"addPolygon"===e.type?i._viewer.placePolygon.viewModel.Show():"addModel"===e.type?i._viewer.placeModel.viewModel.Show():"editPoint"===e.type?i._viewer.placePoint.viewModel.Edit(e.value):"editPolyline"===e.type?i._viewer.placePolyline.viewModel.Edit(e.value):"editPolygon"===e.type?i._viewer.placePolygon.viewModel.Edit(e.value):"editModal"===e.type&&i._viewer.placeModel.viewModel.Edit(e.value)}),this._viewer.placePoint.viewModel.onCreatedEvent.addEventListener(function(e){i._viewer.layersManager.viewModel.updateLayersTree(e)}),this._viewer.placePolyline.viewModel.onCreatedEvent.addEventListener(function(e){i._viewer.layersManager.viewModel.updateLayersTree(e)}),this._viewer.placePolygon.viewModel.onCreatedEvent.addEventListener(function(e){i._viewer.layersManager.viewModel.updateLayersTree(e)}),this._viewer.placeModel.viewModel.onCreatedEvent.addEventListener(function(e){console.log(e),i._viewer.layersManager.viewModel.updateLayersTree(e)})}function viewerPluginsManagerMixin(e){var i=new PluginsManager(document.querySelector(".cesium-viewer"),e);Cesium.defineProperties(e,{pluginsManager:{get:function(){return i}}})}Cesium.defineProperties(PluginsManager.prototype,{viewModel:{get:function(){return this._viewModel}}}),Cesium.defineProperties(PluginsManagerViewMoodel.prototype,{onCreatedEvent:{get:function(){return this._onCreatedEvent}}}),PluginsManagerViewMoodel.prototype.toggleLayesManager=function(){this._viewer.layersManager.viewModel._layersManagerDisplay=!this._viewer.layersManager.viewModel._layersManagerDisplay,this.activeLayerManager=!this.activeLayerManager},PluginsManagerViewMoodel.prototype.pluginsSwitch=function(e){switch(this.destroyAllPlugins(),this.currentTab=e){case"sceneInfomation":this.onCreatedEvent.raiseEvent({type:"show",value:"sceneInfomation"});break;case"sceneManager":this.onCreatedEvent.raiseEvent({type:"show",value:"sceneManager"});break;case"pluginControl":this.onCreatedEvent.raiseEvent({type:"show",value:"pluginControl"});break;case"flightPath":this._viewer.flightPath.viewModel.Show();break;case"classificationEditer":this._viewer.classificationEditer.viewModel.Show();break;case"measure":this._viewer.measurement.viewModel.Show();break;case"placePoint":this._viewer.placePoint.viewModel.Show();break;case"placePolyline":this._viewer.placePolyline.viewModel.Show();break;case"placePolygon":this._viewer.placePolygon.viewModel.Show();break;case"placeModel":this._viewer.placeModel.viewModel.Show()}},PluginsManagerViewMoodel.prototype.destroyAllPlugins=function(){this.onCreatedEvent.raiseEvent({type:"close"}),this._viewer.placePoint.viewModel.hidden(),this._viewer.placePolyline.viewModel.hidden(),this._viewer.placePolygon.viewModel.hidden(),this._viewer.placeModel.viewModel.hidden(),this._viewer.flightPath.viewModel.hidden(),this._viewer.classificationEditer.viewModel.hidden(),this._viewer.measurement.viewModel.hidden()},PluginsManagerViewMoodel.prototype.fromJSON=function(e){this.clientPlugins=e,this.sceneServiceType&&(this._viewer.geocoder.container.hidden=!e.plugin_poi,this._viewer.geocoder.container.parentElement.style.top="10px",this._viewer.navigation.container.hidden=!e.plugin_navigation,document.querySelector(".dataEarth-applyEnter").style.top="55px")};